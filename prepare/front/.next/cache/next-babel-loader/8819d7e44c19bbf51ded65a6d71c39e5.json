{"ast":null,"code":"var __jsx = React.createElement;\n// hashtag/[tag].js\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useRouter } from 'next/router';\nimport { LOAD_POSTS_REQUEST } from '../../reducers/post';\nimport PostCard from '../../components/PostCard';\nimport AppLayout from '../../components/Applayout';\n\nvar Hashtag = function Hashtag() {\n  var dispatch = useDispatch();\n  var router = useRouter();\n  var tag = router.query.tag;\n\n  var _useSelector = useSelector(function (state) {\n    return state.post;\n  }),\n      mainPosts = _useSelector.mainPosts,\n      hasMorePosts = _useSelector.hasMorePosts,\n      loadPostsLoading = _useSelector.loadPostsLoading;\n\n  useEffect(function () {\n    if (hasMorePosts && !loadPostsLoading) {\n      var _mainPosts;\n\n      var lastId = (_mainPosts = mainPosts[mainPosts.length - 1]) === null || _mainPosts === void 0 ? void 0 : _mainPosts.id;\n      dispatch({\n        type: LOAD_POSTS_REQUEST,\n        lastId: lastId,\n        data: tag\n      });\n    }\n  }, [hasMorePosts, loadPostsLoading, mainPosts, tag]);\n  return __jsx(AppLayout, null, mainPosts.map(function (c) {\n    return __jsx(PostCard, {\n      key: c.id,\n      post: c\n    });\n  }), __jsx(\"div\", {\n    ref: hasMorePosts && !loadPostsLoading ? ref : undefined\n  }));\n};\n\nexport var __N_SSP = true;\nexport default Hashtag;","map":{"version":3,"sources":["/Users/heoseongjin/Desktop/node_bird/prepare/front/pages/hashtag/[tag].js"],"names":["React","useEffect","useDispatch","useSelector","useRouter","LOAD_POSTS_REQUEST","PostCard","AppLayout","Hashtag","dispatch","router","tag","query","state","post","mainPosts","hasMorePosts","loadPostsLoading","lastId","length","id","type","data","map","c","ref","undefined"],"mappings":";AAAA;AACA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,SAAT,QAA0B,aAA1B;AAIA,SAAqCC,kBAArC,QAA+D,qBAA/D;AACA,OAAOC,QAAP,MAAqB,2BAArB;AAGA,OAAOC,SAAP,MAAsB,4BAAtB;;AAEA,IAAMC,OAAO,GAAG,SAAVA,OAAU,GAAM;AACpB,MAAMC,QAAQ,GAAGP,WAAW,EAA5B;AACA,MAAMQ,MAAM,GAAGN,SAAS,EAAxB;AACA,MAAQO,GAAR,GAAgBD,MAAM,CAACE,KAAvB,CAAQD,GAAR;;AACA,qBAAsDR,WAAW,CAAC,UAACU,KAAD;AAAA,WAAWA,KAAK,CAACC,IAAjB;AAAA,GAAD,CAAjE;AAAA,MAAQC,SAAR,gBAAQA,SAAR;AAAA,MAAmBC,YAAnB,gBAAmBA,YAAnB;AAAA,MAAiCC,gBAAjC,gBAAiCA,gBAAjC;;AAEAhB,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIe,YAAY,IAAI,CAACC,gBAArB,EAAuC;AAAA;;AACrC,UAAMC,MAAM,iBAAGH,SAAS,CAACA,SAAS,CAACI,MAAV,GAAmB,CAApB,CAAZ,+CAAG,WAAiCC,EAAhD;AACAX,MAAAA,QAAQ,CAAC;AACPY,QAAAA,IAAI,EAAEhB,kBADC;AAEPa,QAAAA,MAAM,EAANA,MAFO;AAGPI,QAAAA,IAAI,EAAEX;AAHC,OAAD,CAAR;AAKD;AACF,GATQ,EASN,CAACK,YAAD,EAAeC,gBAAf,EAAiCF,SAAjC,EAA4CJ,GAA5C,CATM,CAAT;AAWA,SACE,MAAC,SAAD,QACGI,SAAS,CAACQ,GAAV,CAAc,UAACC,CAAD;AAAA,WACb,MAAC,QAAD;AAAU,MAAA,GAAG,EAAEA,CAAC,CAACJ,EAAjB;AAAqB,MAAA,IAAI,EAAEI;AAA3B,MADa;AAAA,GAAd,CADH,EAIE;AAAK,IAAA,GAAG,EAAER,YAAY,IAAI,CAACC,gBAAjB,GAAoCQ,GAApC,GAA0CC;AAApD,IAJF,CADF;AAQD,CAzBD;;;AA4CA,eAAelB,OAAf","sourcesContent":["// hashtag/[tag].js\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useRouter } from 'next/router';\nimport { END } from 'redux-saga';\n\nimport axios from 'axios';\nimport { LOAD_HASHTAG_POSTS_REQUEST, LOAD_POSTS_REQUEST } from '../../reducers/post';\nimport PostCard from '../../components/PostCard';\nimport wrapper from '../../store/configureStore';\nimport { LOAD_MY_INFO_REQUEST } from '../../reducers/user';\nimport AppLayout from '../../components/Applayout';\n\nconst Hashtag = () => {\n  const dispatch = useDispatch();\n  const router = useRouter();\n  const { tag } = router.query;\n  const { mainPosts, hasMorePosts, loadPostsLoading } = useSelector((state) => state.post);\n\n  useEffect(() => {\n    if (hasMorePosts && !loadPostsLoading) {\n      const lastId = mainPosts[mainPosts.length - 1]?.id;\n      dispatch({\n        type: LOAD_POSTS_REQUEST,\n        lastId,\n        data: tag,\n      });\n    }\n  }, [hasMorePosts, loadPostsLoading, mainPosts, tag]);\n\n  return (\n    <AppLayout>\n      {mainPosts.map((c) => (\n        <PostCard key={c.id} post={c} />\n      ))}\n      <div ref={hasMorePosts && !loadPostsLoading ? ref : undefined} />\n    </AppLayout>\n  );\n};\n\nexport const getServerSideProps = wrapper.getServerSideProps((store) => async ({ req, params }) => {\n  const cookie = req ? req.headers.cookie : '';\n  axios.defaults.headers.Cookie = '';\n  if (req && cookie) {\n    axios.defaults.headers.Cookie = cookie;\n  }\n  store.dispatch({\n    type: LOAD_MY_INFO_REQUEST,\n  });\n  store.dispatch({\n    type: LOAD_HASHTAG_POSTS_REQUEST,\n    data: params.tag,\n  });\n  store.dispatch(END);\n  await store.sagaTask.toPromise();\n});\n\nexport default Hashtag;\n"]},"metadata":{},"sourceType":"module"}