{"version":3,"file":"../pages/index.js","mappings":"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","sources":["webpack://react-nodebird-front/./components/PostForm.js","webpack://react-nodebird-front/./pages/index.js","webpack://react-nodebird-front/external \"@ant-design/icons\"","webpack://react-nodebird-front/external \"antd\"","webpack://react-nodebird-front/external \"axios\"","webpack://react-nodebird-front/external \"immer\"","webpack://react-nodebird-front/external \"moment\"","webpack://react-nodebird-front/external \"next-redux-wrapper\"","webpack://react-nodebird-front/external \"next/dist/server/denormalize-page-path.js\"","webpack://react-nodebird-front/external \"next/dist/shared/lib/i18n/normalize-locale-path.js\"","webpack://react-nodebird-front/external \"next/dist/shared/lib/mitt.js\"","webpack://react-nodebird-front/external \"next/dist/shared/lib/router-context.js\"","webpack://react-nodebird-front/external \"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\"","webpack://react-nodebird-front/external \"next/dist/shared/lib/router/utils/is-dynamic.js\"","webpack://react-nodebird-front/external \"next/dist/shared/lib/router/utils/parse-relative-url.js\"","webpack://react-nodebird-front/external \"next/dist/shared/lib/router/utils/querystring.js\"","webpack://react-nodebird-front/external \"next/dist/shared/lib/router/utils/route-matcher.js\"","webpack://react-nodebird-front/external \"next/dist/shared/lib/router/utils/route-regex.js\"","webpack://react-nodebird-front/external \"next/dist/shared/lib/utils.js\"","webpack://react-nodebird-front/external \"next/router\"","webpack://react-nodebird-front/external \"react\"","webpack://react-nodebird-front/external \"react-redux\"","webpack://react-nodebird-front/external \"react-slick\"","webpack://react-nodebird-front/external \"react/jsx-runtime\"","webpack://react-nodebird-front/external \"redux\"","webpack://react-nodebird-front/external \"redux-devtools-extension\"","webpack://react-nodebird-front/external \"redux-saga\"","webpack://react-nodebird-front/external \"redux-saga/effects\"","webpack://react-nodebird-front/external \"styled-components\""],"sourcesContent":["import React, { useCallback, useRef, useEffect } from 'react';\nimport { Form, Input, Button } from 'antd';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport { UPLOAD_IMAGES_REQUEST, REMOVE_IMAGE, ADD_POST_REQUEST } from '../reducers/post';\nimport useInput from '../hooks/useInput';\nimport { backUrl } from '../config/config';\n\nconst PostForm = () => {\n  const { imagePaths, addPostDone } = useSelector((state) => state.post);\n\n  const dispatch = useDispatch();\n\n  const [text, onChangeText, setText] = useInput('');\n  // const onChangeText = useCallback((e) => {\n  //   setText(e.target.value);\n  // }, []);\n\n  useEffect(() => {\n    if (addPostDone) {\n      setText('');\n    }\n  }, [addPostDone]);\n\n  const onSubmit = useCallback(() => {\n    if (!text || !text.trim()) {\n      return alert('게시글을 작성하세요');\n    }\n    const formData = new FormData();\n    imagePaths.forEach((p) => {\n      formData.append('image', p);\n    });\n    formData.append('content', text);\n    return dispatch({\n      type: ADD_POST_REQUEST,\n      data: formData,\n    });\n  }, [text, imagePaths]);\n\n  const imageInput = useRef();\n  const onClickImageUpload = useCallback(() => {\n    imageInput.current.click();\n  }, [imageInput.current]);\n\n  const onChanfeImages = useCallback((e) => {\n    console.log('images ', e.target.files);\n    const imageFormData = new FormData();\n    [].forEach.call(e.target.files, (f) => {\n      imageFormData.append('image', f);\n    });\n    dispatch({\n      type: UPLOAD_IMAGES_REQUEST,\n      data: imageFormData,\n    });\n  }, []);\n\n  const onRemoveImage = useCallback(\n    (index) => () => {\n      dispatch({\n        type: REMOVE_IMAGE,\n        data: index,\n      });\n    },\n    [],\n  );\n  return (\n    <Form style={{ margin: '10px 0 20px' }} encType=\"multipart/form-data\" onFinish={onSubmit}>\n      <Input.TextArea\n        value={text}\n        onChange={onChangeText}\n        maxLength={140}\n        placeholder=\"어떤 신기한 일이 있엇나요?\"\n      />\n\n      <div>\n        <input\n          type=\"file\"\n          name=\"image\"\n          multiple\n          hidden\n          ref={imageInput}\n          onChange={onChanfeImages}\n        />\n        <Button onClick={onClickImageUpload}>이미지 업로드</Button>\n        <Button type=\"primary\" style={{ float: 'right' }} htmlType=\"submit\">\n          쨱쨱\n        </Button>\n      </div>\n\n      <div>\n        {imagePaths.map((v, i) => (\n          <div key={v} style={{ display: 'inline-block' }}>\n            <img src={`${backUrl}/${v}`} style={{ width: '200px' }} alt={v} />\n            <div>\n              <Button onClick={onRemoveImage(i)}>제거</Button>\n            </div>\n          </div>\n        ))}\n      </div>\n    </Form>\n  );\n};\n\nexport default PostForm;\n","import React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport axios from 'axios';\nimport { END } from 'redux-saga';\nimport AppLayout from '../components/AppLayout';\nimport PostForm from '../components/PostForm';\nimport PostCard from '../components/PostCard';\nimport { LOAD_POSTS_REQUEST } from '../reducers/post';\nimport { LOAD_MY_INFO_REQUEST } from '../reducers/user';\nimport wrapper from '../store/configureStore';\n\nconst Home = () => {\n  const dispatch = useDispatch();\n\n  const { me } = useSelector((state) => state.user);\n  const { mainPosts, hasMorePosts, loadPostsLoading, retweetError } = useSelector(\n    (state) => state.post,\n  );\n\n  useEffect(() => {\n    if (retweetError) {\n      alert(retweetError);\n    }\n  }, [retweetError]);\n\n  useEffect(() => {\n    function onScroll() {\n      // console.log(\n      //   window.scrollY,\n      //   document.documentElement.clientHeight,\n      //   document.documentElement.scrollHeight,\n      //   -300,\n      // );\n      if (\n        window.scrollY + document.documentElement.clientHeight >\n        document.documentElement.scrollHeight - 300\n      ) {\n        if (hasMorePosts && !loadPostsLoading) {\n          const lastId = mainPosts[mainPosts.length - 1]?.id;\n          dispatch({\n            type: LOAD_POSTS_REQUEST,\n            lastId,\n          });\n        }\n      }\n    }\n\n    window.addEventListener('scroll', onScroll);\n    return () => {\n      window.removeEventListener('scroll', onScroll);\n    };\n  }, [hasMorePosts, loadPostsLoading, mainPosts]);\n\n  return (\n    <AppLayout>\n      {me && <PostForm />}\n      {mainPosts.map((post) => {\n        return <PostCard key={post.id} post={post} />;\n      })}\n    </AppLayout>\n  );\n};\n\nexport const getServerSideProps = wrapper.getServerSideProps((store) => async ({ req }) => {\n  // 로그인이 풀리는 현상, 서버에서 공유하지 않는 쿠ㄱ\n  const cookie = req ? req.headers.cookie : '';\n  axios.defaults.headers.Cookie = '';\n  if (req && cookie) {\n    axios.defaults.headers.Cookie = cookie;\n  }\n  store.dispatch({\n    type: LOAD_MY_INFO_REQUEST,\n  });\n  store.dispatch({\n    type: LOAD_POSTS_REQUEST,\n  });\n  store.dispatch(END);\n  await store.sagaTask.toPromise();\n});\n\nexport default Home;\n","module.exports = require(\"@ant-design/icons\");","module.exports = require(\"antd\");","module.exports = require(\"axios\");","module.exports = require(\"immer\");","module.exports = require(\"moment\");","module.exports = require(\"next-redux-wrapper\");","module.exports = require(\"next/dist/server/denormalize-page-path.js\");","module.exports = require(\"next/dist/shared/lib/i18n/normalize-locale-path.js\");","module.exports = require(\"next/dist/shared/lib/mitt.js\");","module.exports = require(\"next/dist/shared/lib/router-context.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/is-dynamic.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/parse-relative-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/querystring.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-matcher.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-regex.js\");","module.exports = require(\"next/dist/shared/lib/utils.js\");","module.exports = require(\"next/router\");","module.exports = require(\"react\");","module.exports = require(\"react-redux\");","module.exports = require(\"react-slick\");","module.exports = require(\"react/jsx-runtime\");","module.exports = require(\"redux\");","module.exports = require(\"redux-devtools-extension\");","module.exports = require(\"redux-saga\");","module.exports = require(\"redux-saga/effects\");","module.exports = require(\"styled-components\");"],"names":["React","useCallback","useRef","useEffect","Form","Input","Button","useSelector","useDispatch","UPLOAD_IMAGES_REQUEST","REMOVE_IMAGE","ADD_POST_REQUEST","useInput","backUrl","PostForm","imagePaths","addPostDone","state","post","dispatch","text","onChangeText","setText","onSubmit","trim","alert","formData","FormData","forEach","p","append","type","data","imageInput","onClickImageUpload","current","click","onChanfeImages","e","console","log","target","files","imageFormData","call","f","onRemoveImage","index","margin","float","map","v","i","display","width","axios","END","AppLayout","PostCard","LOAD_POSTS_REQUEST","LOAD_MY_INFO_REQUEST","wrapper","Home","me","user","mainPosts","hasMorePosts","loadPostsLoading","retweetError","onScroll","window","scrollY","document","documentElement","clientHeight","scrollHeight","lastId","length","id","addEventListener","removeEventListener","getServerSideProps","store","req","cookie","headers","defaults","Cookie","sagaTask","toPromise"],"sourceRoot":""}